<svg
  width="{{ width }}"
  height="{{ height }}"
  viewBox="0 0 {{ width }} {{ height }}"
  xmlns="http://www.w3.org/2000/svg"
  xmlns:xlink="http://www.w3.org/1999/xlink"
  aria-labelledby="card-title"
  role="img"
>
  <title id="card-title">Now playing on Spotify</title>
  <foreignObject width="{{ width }}" height="{{ height }}">
    {% include 'partial/svg-font.html.j2' %}

    <style>
      <!-- Basic styling -->
      div {
        font-family: 'Poppins', -apple-system, BlinkMacSystemFont, Segoe UI, Helvetica, Arial, sans-serif, Apple Color Emoji, Segoe UI Emoji;
        background-color: {{ background_color | safe }};
      }

      .main {
        color: {{ text_color | safe }};
        margin-top: 15px;
        display: flex;
      }

      .container {
        display: flex;
        align-items: center;
        border-radius: 10px;
        padding: 10px 10px;
      }

      <!-- Song related styling -->
      .cover {
        border-radius: 1px;
        margin-right: 10px;
        margin-top: -5px;
      }

      .cover-link {
        height: 64px;
      }

      .artist {
        font-weight: 500;
        font-size: 14px;
        margin-bottom: 15px;
      }

      .song {
        font-size: 14px;
        margin-bottom: 10px;
      }

      .explicit-music {
        background-color: {{ text_color | safe }};
        color: {{ bg_color | safe }};
        font-size: 10px;
        border-radius: 5px;
        vertical-align: baseline;
        padding: 1px 3px 1px 3px;
        margin-top: 0;
        margin-left: 3px;
      }

      <!-- Playing status -->
      .playing {
        display: flex;
        justify-content: center;
        align-items: center;
        font-weight: bold;
        text-align: center;
        margin-bottom: 8px;
      }

      .not-playing {
        text-align: center;
        margin-bottom: 0;
      }

      <!-- Bars -->
      #bars {
        position: absolute;
        height: 6px;
        width: 220px;
        overflow: hidden;
        margin: -6px 0 0 0px;
      }

      .bar {
        background: #53b14f;
        bottom: 1px;
        height: 3px;
        position: absolute;
        width: 3px;
        animation: sound 0ms -800ms linear infinite alternate;
      }

      <!-- Animation for the bars -->
      @keyframes sound {
          0% {
            opacity: .35;
            height: 3px;
          }
          100% {
            opacity: 1;
            height: 6px;
          }
      }

      <!-- Display the CSS bar -->
      {{ css_bar | safe }}
    </style>

    <div xmlns="http://www.w3.org/1999/xhtml" class="container">
      {% if is_now_playing %}
      <div class="main">
        <!-- Cover section -->
        {% if display_cover %}
        <a class="cover-link">
          <center>
            <img
              src="data:image/png;base64, {{ image }}"
              width="75"
              height="75"
              class="cover"
            />
          </center>
        </a>
        {% endif %}

        <!-- Song details -->
        <div class="text-container">
          <div class="song">
            {% if explicit %}
              <span class="explicit-music">E</span>
            {% endif %}

            {{song_name}}
          </div>

          <div class="artist">{{ artist_name }}</div>

          <div id="bars">{{ content_bar | safe }}</div>
        </div>
      </div>
      {% else %}
      <!-- If not currently playing -->
      <div class="main">
        <!-- Cover for when not playing -->
        {% if display_cover %}
        <a target="_BLANK" class="cover-link">
          <center>
            <img
              src="data:image/gif;base64,R0lGODlhAQABAPAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="
              width="85"
              height="85"
            />
          </center>
        </a>
        {% endif %}
        <div class="playing not-playing">Nothing playing on Spotify</div>
      </div>
      {% endif %}
    </div>
  </foreignObject>
</svg>
